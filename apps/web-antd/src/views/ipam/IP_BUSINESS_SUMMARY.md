# IPä¸šåŠ¡ç®¡ç†åŠŸèƒ½å®ç°æ€»ç»“

## ğŸ“‹ æ¦‚è¿°

åŸºäºåç«¯æä¾›çš„IPä¸šåŠ¡é€»è¾‘APIï¼Œæˆ‘å·²ç»å®Œæˆäº†å‰ç«¯IPåœ°å€åˆ†é…ã€å›æ”¶ã€æ‰¹é‡æ“ä½œç­‰å®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½å®ç°ã€‚

## ğŸ¯ å·²å®ŒæˆåŠŸèƒ½

### 1. APIæ¥å£å±‚ (`apps/web-antd/src/api/ipam/ip-business.ts`)

âœ… **æ•°æ®ç±»å‹å®šä¹‰**
- AllocateIpReq/Resp - IPåˆ†é…è¯·æ±‚å’Œå“åº”
- ReleaseIpReq - IPå›æ”¶è¯·æ±‚
- BatchAllocateIpReq/Resp - æ‰¹é‡åˆ†é…
- BatchReleaseIpReq - æ‰¹é‡å›æ”¶
- PingIpReq/Resp - è¿é€šæ€§æ£€æµ‹
- SubnetStatsReq/Resp - ç½‘æ®µç»Ÿè®¡
- DetectIpConflictReq/Resp - å†²çªæ£€æµ‹
- IpAllocationRecord - IPåˆ†é…è®°å½•

âœ… **APIæ¥å£æ–¹æ³•**
- `allocateIp()` - åˆ†é…IPåœ°å€
- `releaseIp()` - å›æ”¶IPåœ°å€
- `batchAllocateIp()` - æ‰¹é‡åˆ†é…IP
- `batchReleaseIp()` - æ‰¹é‡å›æ”¶IP
- `pingIp()` - IPè¿é€šæ€§æ£€æµ‹
- `getSubnetStats()` - è·å–ç½‘æ®µç»Ÿè®¡
- `detectIpConflict()` - æ£€æµ‹IPå†²çª
- `getIpAllocationList()` - è·å–IPåˆ†é…è®°å½•

### 2. IPç®¡ç†ç»„ä»¶ (`apps/web-antd/src/views/ipam/subnet/components/IpManagement.vue`)

âœ… **ç»Ÿè®¡ä¿¡æ¯å±•ç¤º**
- æ€»IPåœ°å€æ•°é‡
- å·²åˆ†é…/å¯ç”¨/ä¿ç•™/å†²çªIPç»Ÿè®¡
- ä½¿ç”¨ç‡è¿›åº¦æ¡æ˜¾ç¤º
- å®æ—¶æ•°æ®æ›´æ–°

âœ… **IPåˆ†é…åŠŸèƒ½**
- ğŸ¯ **è‡ªåŠ¨åˆ†é…** - ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©å¯ç”¨IP
- ğŸ¯ **æ‰‹åŠ¨æŒ‡å®š** - ç”¨æˆ·æŒ‡å®šå…·ä½“IPåœ°å€
- ğŸ“ èµ„äº§IDå…³è”
- ğŸ’¬ å¤‡æ³¨ä¿¡æ¯
- âœ… IPåœ°å€æ ¼å¼éªŒè¯

âœ… **æ‰¹é‡åˆ†é…åŠŸèƒ½**
- ğŸ“Š æŒ‡å®šåˆ†é…æ•°é‡ï¼ˆ1-100ä¸ªï¼‰
- ğŸ”— å…³è”èµ„äº§ID
- ğŸ’¬ æ‰¹é‡å¤‡æ³¨
- âš¡ é«˜æ•ˆæ‰¹é‡å¤„ç†

âœ… **IPå›æ”¶åŠŸèƒ½**
- ğŸ—‘ï¸ **å•ä¸ªå›æ”¶** - ç‚¹å‡»å›æ”¶æŒ‰é’®
- ğŸ—‚ï¸ **æ‰¹é‡å›æ”¶** - é€‰æ‹©å¤šä¸ªIPæ‰¹é‡å›æ”¶
- âš ï¸ ç¡®è®¤å¯¹è¯æ¡†é˜²è¯¯æ“ä½œ
- ğŸ“ å›æ”¶å¤‡æ³¨è®°å½•

âœ… **è¿é€šæ€§æ£€æµ‹**
- ğŸ” **å…¨é‡æ£€æµ‹** - æ£€æµ‹æ‰€æœ‰å·²åˆ†é…IP
- ğŸ¯ **å•ä¸ªæ£€æµ‹** - æ£€æµ‹ç‰¹å®šIPåœ°å€
- ğŸ“¦ **æ‰¹é‡æ£€æµ‹** - æ£€æµ‹é€‰ä¸­çš„å¤šä¸ªIP
- ğŸ“Š æ£€æµ‹ç»“æœç»Ÿè®¡ï¼ˆåœ¨çº¿/ç¦»çº¿æ•°é‡ï¼‰
- â±ï¸ å“åº”æ—¶é—´æ˜¾ç¤º

âœ… **å†²çªæ£€æµ‹**
- ğŸ” ç½‘æ®µå†…IPå†²çªæ£€æµ‹
- âš ï¸ å†²çªæ•°é‡ç»Ÿè®¡
- ğŸ“‹ è¯¦ç»†å†²çªä¿¡æ¯

âœ… **æ•°æ®ç­›é€‰**
- ğŸ” **æœç´¢åŠŸèƒ½** - IPåœ°å€ã€ä¸»æœºåã€MACåœ°å€ã€èµ„äº§å
- ğŸ“‹ **çŠ¶æ€ç­›é€‰** - å·²åˆ†é…/å¯ç”¨/ä¿ç•™/å†²çª
- ğŸŒ **åœ¨çº¿çŠ¶æ€ç­›é€‰** - åœ¨çº¿/ç¦»çº¿/æœªçŸ¥
- ğŸ“„ åˆ†é¡µæ˜¾ç¤º

âœ… **è¡¨æ ¼æ˜¾ç¤º**
- ğŸ“Š å®Œæ•´çš„IPåˆ†é…è®°å½•è¡¨æ ¼
- ğŸ¨ çŠ¶æ€å›¾æ ‡å’Œé¢œè‰²æ ‡è¯†
- ğŸ“± å“åº”å¼è®¾è®¡
- âœ… è¡Œé€‰æ‹©åŠŸèƒ½
- ğŸ”§ æ“ä½œæŒ‰é’®ï¼ˆå›æ”¶ã€æ£€æµ‹ã€ç¼–è¾‘ï¼‰

### 3. ç½‘æ®µè¯¦æƒ…é›†æˆ (`apps/web-antd/src/views/ipam/subnet/components/SubnetDetail.vue`)

âœ… **åŸºç¡€ä¿¡æ¯å±•ç¤º**
- ç½‘æ®µåç§°ã€CIDRã€ç½‘å…³ç­‰åŸºæœ¬ä¿¡æ¯
- æ‰€å±ç½‘åŸŸã€VLANä¿¡æ¯
- åˆ†é…ç­–ç•¥ã€çŠ¶æ€ç­‰

âœ… **IPç®¡ç†é›†æˆ**
- é›†æˆIpManagementç»„ä»¶
- ç½‘æ®µè¯¦æƒ…é¡µé¢ç›´æ¥è¿›è¡ŒIPç®¡ç†æ“ä½œ

### 4. ä¸»é¡µé¢é›†æˆ (`apps/web-antd/src/views/ipam/subnet/index.vue`)

âœ… **æ“ä½œå…¥å£**
- æ–°å¢"IPç®¡ç†"æŒ‰é’®
- å¿«é€Ÿè¿›å…¥IPç®¡ç†åŠŸèƒ½
- ä¿ç•™åŸæœ‰çš„è¯¦æƒ…ã€ç¼–è¾‘ã€åˆ é™¤åŠŸèƒ½

## ğŸ”§ æŠ€æœ¯ç‰¹æ€§

### ğŸ¨ UI/UXè®¾è®¡
- **ç°ä»£åŒ–ç•Œé¢** - ä½¿ç”¨Ant Design Vueç»„ä»¶åº“
- **å“åº”å¼å¸ƒå±€** - é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- **çŠ¶æ€å¯è§†åŒ–** - ä¸°å¯Œçš„å›¾æ ‡å’Œé¢œè‰²æ ‡è¯†
- **æ“ä½œæµç•…** - åˆç†çš„åŠ è½½çŠ¶æ€å’Œç”¨æˆ·åé¦ˆ

### ğŸ›¡ï¸ æ•°æ®å®‰å…¨
- **è¡¨å•éªŒè¯** - IPåœ°å€æ ¼å¼ã€æ•°é‡èŒƒå›´ç­‰éªŒè¯
- **ç¡®è®¤å¯¹è¯æ¡†** - å±é™©æ“ä½œï¼ˆå›æ”¶ã€åˆ é™¤ï¼‰äºŒæ¬¡ç¡®è®¤
- **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸æ•è·å’Œç”¨æˆ·æç¤º

### âš¡ æ€§èƒ½ä¼˜åŒ–
- **æŒ‰éœ€åŠ è½½** - ç»„ä»¶æ‡’åŠ è½½
- **æ•°æ®ç¼“å­˜** - åˆç†çš„æ•°æ®æ›´æ–°ç­–ç•¥
- **æ‰¹é‡æ“ä½œ** - æ”¯æŒæ‰¹é‡å¤„ç†æé«˜æ•ˆç‡

### ğŸ”„ å®æ—¶æ›´æ–°
- **è‡ªåŠ¨åˆ·æ–°** - æ“ä½œå®Œæˆåè‡ªåŠ¨æ›´æ–°æ•°æ®
- **çŠ¶æ€åŒæ­¥** - å®æ—¶åæ˜ IPåˆ†é…çŠ¶æ€å˜åŒ–

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. IPåˆ†é…æ“ä½œ

```typescript
// è‡ªåŠ¨åˆ†é…
await IpBusinessApi.allocateIp({
  subnetId: 1,
  assetId: 100,
  remark: 'ä¸ºæœåŠ¡å™¨åˆ†é…IP'
});

// æ‰‹åŠ¨æŒ‡å®šIP
await IpBusinessApi.allocateIp({
  subnetId: 1,
  ipAddr: '192.168.1.100',
  assetId: 100,
  remark: 'æŒ‡å®šIPåˆ†é…'
});
```

### 2. æ‰¹é‡åˆ†é…æ“ä½œ

```typescript
await IpBusinessApi.batchAllocateIp({
  subnetId: 1,
  count: 10,
  assetId: 100,
  remark: 'æ‰¹é‡åˆ†é…ç»™é›†ç¾¤èŠ‚ç‚¹'
});
```

### 3. IPå›æ”¶æ“ä½œ

```typescript
// å•ä¸ªå›æ”¶
await IpBusinessApi.releaseIp({
  ipId: 12345,
  remark: 'è®¾å¤‡ä¸‹çº¿å›æ”¶'
});

// æ‰¹é‡å›æ”¶
await IpBusinessApi.batchReleaseIp({
  ipIds: [1, 2, 3, 4, 5],
  remark: 'æ‰¹é‡å›æ”¶'
});
```

### 4. è¿é€šæ€§æ£€æµ‹

```typescript
const response = await IpBusinessApi.pingIp({
  ipIds: [1, 2, 3]
});

// å¤„ç†æ£€æµ‹ç»“æœ
response.data.results.forEach(result => {
  if (result.isOnline) {
    console.log(`IP ${result.ipAddr} åœ¨çº¿ï¼Œå“åº”æ—¶é—´ï¼š${result.pingTime}ms`);
  } else {
    console.log(`IP ${result.ipAddr} ç¦»çº¿ï¼š${result.errorMsg}`);
  }
});
```

## ğŸ”— APIéœ€æ±‚å¯¹æ¥

æ‰€æœ‰æ¥å£éƒ½åŸºäºåç«¯æä¾›çš„APIè§„èŒƒå®ç°ï¼š

- **åŸºç¡€URL**: `/ip-business-api/`
- **è®¤è¯æ–¹å¼**: JWT Token
- **æ•°æ®æ ¼å¼**: JSON
- **çŠ¶æ€ç **: æ ‡å‡†HTTPçŠ¶æ€ç 

å…·ä½“æ¥å£è·¯å¾„ï¼š
- `POST /ip-business-api/allocate` - IPåˆ†é…
- `POST /ip-business-api/release` - IPå›æ”¶
- `POST /ip-business-api/batch_allocate` - æ‰¹é‡åˆ†é…
- `POST /ip-business-api/batch_release` - æ‰¹é‡å›æ”¶
- `POST /ip-business-api/ping` - è¿é€šæ€§æ£€æµ‹
- `POST /ip-business-api/stats` - ç½‘æ®µç»Ÿè®¡
- `POST /ip-business-api/conflict_detect` - å†²çªæ£€æµ‹
- `POST /ip-business-api/allocations` - IPåˆ†é…è®°å½•æŸ¥è¯¢

## ğŸ“ æ€»ç»“

âœ… **åŠŸèƒ½å®Œæ•´æ€§**: è¦†ç›–äº†IPåœ°å€ç®¡ç†çš„å…¨ç”Ÿå‘½å‘¨æœŸï¼Œä»åˆ†é…åˆ°å›æ”¶ã€ä»å•ä¸ªåˆ°æ‰¹é‡ã€ä»æ£€æµ‹åˆ°ç»Ÿè®¡

âœ… **ç”¨æˆ·ä½“éªŒ**: æä¾›äº†ç›´è§‚çš„æ“ä½œç•Œé¢å’Œä¸°å¯Œçš„äº¤äº’åé¦ˆ

âœ… **æŠ€æœ¯è§„èŒƒ**: éµå¾ªVue 3 + TypeScript + Ant Design Vueçš„æœ€ä½³å®è·µ

âœ… **æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåç»­åŠŸèƒ½æ‰©å±•å’Œç»´æŠ¤

è¿™å¥—IPä¸šåŠ¡ç®¡ç†ç³»ç»Ÿä¸ºIPAMå¹³å°æä¾›äº†å®Œæ•´çš„IPåœ°å€ç”Ÿå‘½å‘¨æœŸç®¡ç†èƒ½åŠ›ï¼Œå¤§å¤§æå‡äº†ç½‘ç»œèµ„æºç®¡ç†çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚ 
